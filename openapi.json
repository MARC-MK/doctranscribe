{"openapi":"3.1.0","info":{"title":"DocTranscribe API","version":"0.1.0"},"paths":{"/extract/test":{"get":{"summary":"Extract Test","description":"Simple test endpoint to check if the server is running.","operationId":"extract_test_extract_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/extract/test-openai":{"get":{"tags":["extraction"],"summary":"Test Openai","description":"Test endpoint that directly calls OpenAI API.","operationId":"test_openai_extract_test_openai_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/extract/":{"post":{"tags":["extraction"],"summary":"Extract Route","operationId":"extract_route_extract__post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_extract_route_extract__post"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/extract/batch":{"post":{"tags":["extraction"],"summary":"Batch Extract","description":"Process a batch of survey PDFs with background processing","operationId":"batch_extract_extract_batch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchJobRequest"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchJobResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/extract/batch/{batch_id}":{"get":{"tags":["extraction"],"summary":"Get Batch Status","description":"Get the status of a batch job","operationId":"get_batch_status_extract_batch__batch_id__get","parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"string","title":"Batch Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/upload/":{"post":{"tags":["ingestion"],"summary":"Upload File","operationId":"upload_file_upload__post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_upload__post"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PDFMetadataResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/results/":{"get":{"tags":["extraction"],"summary":"Get Results","operationId":"get_results_results__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/results/{job_id}/xlsx-url":{"get":{"tags":["extraction"],"summary":"Get Xlsx Signed Url","operationId":"get_xlsx_signed_url_results__job_id__xlsx_url_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/XLSXSignedURLResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/results/{job_id}/xlsx":{"get":{"tags":["results"],"summary":"Get Xlsx File","description":"Temporary endpoint to return a mock XLSX file.","operationId":"get_xlsx_file_results__job_id__xlsx_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"download","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Download"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/test":{"get":{"tags":["jobs"],"summary":"Test Jobs Router","description":"Simple test endpoint to check if the jobs router is working.","operationId":"test_jobs_router_jobs_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/jobs/{job_id}/context":{"get":{"tags":["jobs"],"summary":"Get Job Context","description":"Get context for a job, including anomalies and file references.","operationId":"get_job_context_jobs__job_id__context_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobContext"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/assistant/test":{"get":{"tags":["assistant"],"summary":"Test Assistant Router","description":"Simple test endpoint to check if the assistant router is working.","operationId":"test_assistant_router_assistant_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/assistant/chat":{"post":{"tags":["assistant"],"summary":"Chat","description":"Proxy endpoint to OpenAI Assistants API","operationId":"chat_assistant_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/assistant/jobs/{job_id}/anomalies/{row_id}/dismiss":{"post":{"tags":["assistant"],"summary":"Dismiss Anomaly","description":"Dismiss an anomaly by marking it as reviewed","operationId":"dismiss_anomaly_assistant_jobs__job_id__anomalies__row_id__dismiss_post","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"row_id","in":"path","required":true,"schema":{"type":"string","title":"Row Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DismissRequest"}}}},"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"tags":["meta"],"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Check Health Get"}}}}}}},"/temp-upload":{"get":{"summary":"Temp Upload Endpoint","description":"Temporary endpoint to simulate upload functionality.","operationId":"temp_upload_endpoint_temp_upload_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/temp-preview":{"post":{"summary":"Temp Preview Endpoint","description":"Temporary endpoint to simulate file preview.","operationId":"temp_preview_endpoint_temp_preview_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/results":{"get":{"tags":["results"],"summary":"Get Results","description":"Temporary endpoint to return mock results data.","operationId":"get_results_results_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Response Get Results Results Get"}}}}}}},"/results/{job_id}":{"get":{"tags":["results"],"summary":"Get Job Result","description":"Temporary endpoint to return mock job result.","operationId":"get_job_result_results__job_id__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Anomaly":{"properties":{"row_id":{"type":"string","title":"Row Id"},"algorithm":{"type":"string","title":"Algorithm"},"score":{"type":"number","title":"Score"},"dismissed":{"type":"boolean","title":"Dismissed","default":false}},"type":"object","required":["row_id","algorithm","score"],"title":"Anomaly"},"AssistantMessage":{"properties":{"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"}},"type":"object","required":["role","content"],"title":"AssistantMessage"},"BatchJobRequest":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name","description":"Optional batch name"},"file_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"File Count","description":"Number of files to process","default":1}},"type":"object","title":"BatchJobRequest","description":"Request for creating a batch job to process multiple PDFs"},"BatchJobResult":{"properties":{"batch_id":{"type":"string","title":"Batch Id","description":"Unique identifier for the batch job"},"name":{"type":"string","title":"Name","description":"Name of the batch job"},"status":{"type":"string","title":"Status","description":"Current status of the batch (queued, processing, completed, failed)"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message","description":"Optional status message"}},"type":"object","required":["batch_id","name","status"],"title":"BatchJobResult","description":"Response for a batch job creation"},"Body_extract_route_extract__post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_extract_route_extract__post"},"Body_upload_file_upload__post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_upload__post"},"ChatRequest":{"properties":{"job_id":{"type":"string","title":"Job Id"},"user_message":{"type":"string","title":"User Message"}},"type":"object","required":["job_id","user_message"],"title":"ChatRequest"},"ChatResponse":{"properties":{"assistant_messages":{"items":{"$ref":"#/components/schemas/AssistantMessage"},"type":"array","title":"Assistant Messages"}},"type":"object","required":["assistant_messages"],"title":"ChatResponse"},"DismissRequest":{"properties":{"dismissed_by":{"type":"string","title":"Dismissed By"}},"type":"object","required":["dismissed_by"],"title":"DismissRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"JobContext":{"properties":{"json_file_id":{"type":"string","title":"Json File Id"},"anomalies":{"items":{"$ref":"#/components/schemas/Anomaly"},"type":"array","title":"Anomalies"},"xlsx_url":{"type":"string","title":"Xlsx Url"}},"type":"object","required":["json_file_id","anomalies","xlsx_url"],"title":"JobContext"},"JobResult":{"properties":{"sheet_name":{"type":"string","title":"Sheet Name"},"anomalies":{"type":"integer","title":"Anomalies"}},"type":"object","required":["sheet_name","anomalies"],"title":"JobResult"},"PDFMetadataResponse":{"properties":{"filename":{"type":"string","title":"Filename"},"filesize_bytes":{"type":"integer","title":"Filesize Bytes"},"page_count":{"type":"integer","title":"Page Count"},"summary":{"type":"string","title":"Summary"}},"type":"object","required":["filename","filesize_bytes","page_count","summary"],"title":"PDFMetadataResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"XLSXSignedURLResponse":{"properties":{"url":{"type":"string","title":"Url"}},"type":"object","required":["url"],"title":"XLSXSignedURLResponse"}}}}